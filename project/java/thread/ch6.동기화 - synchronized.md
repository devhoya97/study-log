### 은행 출금 문제
- 실행 흐름
  - 계좌 잔액이 출금액보다 많은지 검증한 후, 출금을 진행한다.
  - t1, t2가 동시에 같은 계좌에서 출금을 시도하는데, t1이 검증을 통과한 후 잔액을 갱신하기 전에 t2가 검증을 통과할 수 있다.
- 위와 같은 문제가 발생한 근본 원인은 여러 스레드가 함께 사용하는 공유 자원을 여러 단계로 나누어 사용하기 때문이다.
- 여러가지 방법이 있지만 자바는 synchronized 키워드를 통해 아주 간단하게 임계 영역을 보호할 수 있다.
  - 스레드가 synchronized 키워드가 있는 메서드에 진입하려면 반드시 해당 인스턴스의 락이 있어야 한다.
  - volatile을 사용하지 않아도 synchronized 안에서 접근하는 변수의 메모리 가시성 문제는 해결된다. (happens-before)

### synchronized의 단점
- 무한 대기
  - BLOCKED 상태의 스레드는 락이 풀릴 때까지 무한 대기한다.
  - 특정 시간 만큼만 대기하거나, 중간에 인터럽트를 거는 것이 불가능하다.
- 공정성
  - 락이 돌아왔을 때 BLOCKED 상태의 스레드 중 어떤 스레드가 락을 획득할 지 알 수 없다.
