### 이상현상
- 관련이 없는 속성들이 하나의 릴레이션에 모여있어 불필요한 데이터 중복으로 인해 삽입, 수정, 삭제 연산을 수행할 때 부작용이 발생하는 현상
- 예시 테이블 구조
  - 이벤트참여(<u>고객아이디</u>, <u>이벤트번호</u>, 당첨여부, 고객이름, 등급)
- 종류
  - 삽입 이상
    - 새 데이터를 삽입하기 위해 불필요한 데이터도 함께 삽입해야 하는 문제
    - ex. 이벤트에 참여하지 않은 새로운 고객을 추가하기 위해선 실제로 참여하지 않은 임시 이벤트번호를 삽입해야 한다. 
  - 갱신 이상
    - 중복 튜플 중 일부만 변경하여 데이터가 불일치하게 되는 모순의 문제 
    - ex. 고객아이디가 apple인 튜플이 3개 존재할 때, 하나의 튜플에서만 등급을 변경하면, 같은 고객임에도 나머지 2개의 튜플에서 나타나는 등급이 달라진다.
  - 삭제 이상
    - 튜플을 삭제하면 꼭 필요한 데이터까지 함께 삭제되는 데이터 손실의 문제
    - ex. 고객아이디가 orange인 튜플이 1개 존재할 때, 이벤트 참여를 취소해 이를 삭제하면, 고객이름과 등급까지 삭제된다.

### 함수적 종속성
- 정규화 과정에서 고려해야 하는 속성들 간의 관련성
  - 일반적으로 릴레이션에 함수적 종속성이 하나 존재하도록 정규화를 통해 릴레이션을 분해한다.
- 릴레이션 내의 모든 튜플에서 X 값에 대한 Y값이 항상 하나면 "X가 Y를 함수적으로 결정한다" 또는 "Y가 X에 함수적으로 종속되어 있다"라고 한다.
  - 튜플을 유일하게 구별하는 기본키와 후보키는 릴레이션을 구성하는 다른 모든 속성들을 함수적으로 결정한다.
  - 물론 기본키나 후보키가 아니더라도 속성 Y 값을 유일하게 결정하는 속성 X는 함수 종속 관계에서 모두 결정자가 될 수 있다.
- ex. 예시 테이블에서 고객이름은 고객아이디에 종속되어 있으면서 {고객아이디, 이벤트 번호}에도 종속되어 있다.
  - 이런 경우, 고객이름 속성이 {고객아이디, 이벤트번호} 속성 집합에 부분 함수 종속되었다고 한다.
  - 반면 당첨여부 속성은 {고객아이디, 이벤트번호} 속성 집합 전체에 종속되어 있으므로 속성 집합에 완전 함수 종속되었다고 한다.

### 정규화의 개념과 정규형의 종류
- 함수 종속성을 이용하여 릴레이션을 연관성이 있는 속성들로만 구성되도록 분해해서, 이상 현상이 발생하지 않는 릴레이션으로 만들어나가는 과정이 정규화
  - 정규화의 기본 목표는 관련이 없는 함수 종속성을 별개의 릴레이션으로 표현하는 것
- 각 정규형마다 만족시켜야 하는 제약 조건이 존재한다.
- 예시 테이블 구조
  - 이벤트참여(<u>고객아이디</u>, <u>이벤트번호</u>, 당첨여부, 등급, 할인율)

### 제1정규형
- 릴레이션에 속한 모든 속성의 도메인이 원자 값으로만 구성되어 있으면 제1정규형에 속한다.
- 관계 데이터베이스의 릴레이션은 모든 속성이 원자 값을 가지므로, 최소한 제1정규형을 만족해야 관계 데이터베이스의 릴레이션이 될 자격이 있다.
- 이벤트참여 릴레이션에서 등급과 할인율 속성의 값은 중복되어 나타나는 경우가 많고, 이처럼 불필요한 데이터가 중복되면 삽입,갱신,삭제 이상현상이 발생할 수 있다.
- 릴레이션을 분해하여 부분 함수 종속을 제거하면, 이상 현상이 일부 해소된다.

### 제2정규형
- 릴레이션이 제1정규형에 속하고, 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속되면 제2정규형에 속한다.
- 예시 테이블은 등급, 할인율 속성은 완전 함수 종속되지 않으므로 제2정규형에 속하지 않는다.
- 제2정규형을 만족하도록 분해된 2개의 릴레이션
  - 고객(<u>고객아이디</u>, 등급, 할인율)
  - 이벤트참여(<u>고객아이디</u>, <u>이벤트번호</u>, 당첨여부)
  - 이벤트참여 릴레이션은 함수 종속성을 단 하나만 포함하므로 이상 현상이 더는 발생하지 않는다.
  - 하지만 고객 릴레이션은 부분 함수 종속은 없지만 함수 종속성을 아직도 여러 개 포함하고 있어 모든 종류의 이상현상이 발생할 수 있다.
- 릴레이션을 분해하여 이행적 함수 종속을 제거하면 이상 현상이 대부분 해소된다.
- 정규화 과정에서 릴레이션을 분해할 때 주의점
  - 분해된 릴레이션들을 자연 조인하여 분해 전의 릴레이션으로 다시 복원할 수 있어야 한다.
  - 정보의 손실 없이 릴레이션을 분해한다고 해서 무손실 분해라고 부른다.

### 제3정규형
- 릴레이션이 제2정규형에 속하고, 기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속이 되지 않으면 제3정규형에 속한다.
  - 이행적 함수 종속이란, X -> Y, Y -> Z가 성립할 때, 속성 집합 Z가 속성 집합 X에 이행적으로 함수 종속되었다고 한다.
- 고객 릴레이션이 제3정규형을 만족하도록 분해된 2개의 릴레이션
  - 고객(<u>고객아이디</u>, 등급)
  - 고객등급(<u>등급</u>, 할인율)
- 릴레이션에 후보키가 아닌 결정자가 존재하는 경우, 이상 현상이 발생할 수 있다.

### 보이스/코드 정규형(BCNF)
- 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키이면 보이스/코드 정규형에 속한다.
- 예시 테이블
  - 강좌신청(<u>고객아이디</u>, <u>인터넷강좌</u>, 담당강사번호)
  - 한 고객이 인터넷강좌를 여러 개 신청할 수 있지만, 동일한 인터넷강좌를 여러 번 신청할 수 없다.
  - 강사 한 명이 인터넷강좌를 하나만 담당할 수 있고, 하나의 인터넷강좌는 여러 강사가 담당할 수 있다.
  - 이 경우 후보키로는 {고객아이디, 인터넷강좌}와 {고객아이디, 담당강사번호}가 있다.
  - {고객아이디, 인터넷강좌}를 기본키로 선정한 경우, 담당강사번호는 후보키가 아님에도 인터넷강좌에 대한 결정자가 된다.
  - 따라서 모든 이상현상이 발생할 수 있다.
- 후보키가 아닌 결정자를 제거하기 위해 분해된 2개의 릴레이션
  - 고객담당강사(<u>고객아이디</u>, <u>담당강사번호</u>)
  - 강좌담당(<u>담당강사번호</u>, 인터넷강좌)

### 고급 정규형
- 릴레이션이 보이스/코드 정규형에 속하고, 함수 종속이 아닌 다치 종속을 제거하면 제4정규형에 속한다.
- 릴레이션이 제4정규형에 속하고, 후보키를 통하지 않는 조인 종속을 제거하면 제5정규형에 속한다.
