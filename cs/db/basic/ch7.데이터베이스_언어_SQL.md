### 테이블 생성 시 외래키 제약조건 정의
- 삭제 관련
  - ON DELETE NO ACTION (기본)
  - ON DELETE CASCADE
  - ON DELETE SET NULL
  - ON DELETE SET DEFAULT
- 수정 관련
  - ON UPDATE NO ACTION (기본)
  - ON UPDATE CASCADE
  - ON UPDATE SET NULL
  - ON UPDATE SET DEFAULT

### 데이터 무결성 제약조건의 정의
- CHECK 키워드로 특정 속성에 대한 제약조건을 지정할 수 있다.
  - CHECK 키워드를 사용해 지정한 제약조건에 CONSTRAINT 키워드와 함께 고유의 이름을 부여할 수도 있다.
  - 제약조건을 여러 개 지정할 때 고유의 이름을 부여하면 테이블이 생성된 이후에 제약조건을 수정하거나 제거할 때 식별하기가 쉽다.
- ALTER TABLE 테이블_이름 DROP COLUMN 속성_이름; 으로 기존 속성을 삭제하려 할 때, 이 속성을 참조하는 다른 속성이 존재하는 경우 속성을 삭제할 수 없다.
  - 관련된 제약조건이나 참조하는 다른 속성을 먼저 삭제한 후 해당 속성을 삭제해야 한다.
  - 오라클에서는 CASCADE CONSTRAINTS 옵션을 추가하여 삭제할 속성과 관련된 제약조건을 함께 삭제할 수도 있다.

### SQL
- SELECT문의 결과 테이블은 관계 데이터 모델의 일반 릴레이션과 큰 차이가 있다.
  - 관계 데이터 모델의 일반 릴레이션은 튜플의 집합 개념으로 이해할 수 있으며 튜플의 유일성을 만족해야 하기 때문에 릴레이션 하나에서 동일한 튜플이 중복되면 안 된다.
  - 그러나 SELECT 문의 수행 결과로 반환되는 결과 테이블에서는 동일한 튜플이 중복될 수 있다.
  - 결과 테이블에서 튜플의 중복을 제거하려면 DISTINCT 키워드를 사용한다.
- 검색 조건을 부분적으로만 알고 있다면 LIKE 키워드를 이용해 검색할 수 있다.
  - 단 LIKE 키워드는 문자열을 이용하는 조건에만 사용할 수 있다.
  - % : 0개 이상의 문자 (문자의 내용과 개수는 상관 없음)
  - _ : 1개의 문자 (문자의 내용은 상관 없음)
- NULL을 이용한 검색
  - 검색 조건에서 특정 속성의 값이 널 값인지를 비교하려면 IS NULL 키워드를 사용
  - 널 값이 아닌지를 비교하려면 IS NOT NULL 키워드를 사용
  - 검색 조건에서 널 값은 다른 값과 크기를 비교하면 결과가 모두 false가 된다.
  - 정렬시, 널 값은 오름차순에서는 맨 마지막에 촐력되고 내림차순에서는 맨 먼저 출력된다.
- 집계함수
  - SUM과 AVG 함수는 숫자 데이터 타입의 속성에만 적용할 수 있고, 나머지(COUNT, MAX, MIN)는 숫자 뿐 아니라 문자와 날짜 데이터 타입의 속성에도 적용할 수 있다.
  - 집계 함수는 널인 속성 값은 제외하고 계산한다.
  - 집계 함수는 WHERE 절에서는 사용할 수 없고 SELECT 절이나 HAVING 절에서만 사용할 수 있다.
  - 집계 함수의 결과는 테이블에 원래 있던 내용이 아니라 계산을 통해 새로 생성된 값이므로 속성의 이름이 별도로 지정되어 있지 않다. 
    - AS 키워드를 사용해 새 이름을 부여해주는 것을 권장
  - COUNT 함수는 다른 함수와 달리 테이블의 모든 속성에 적용하여 개수를 계산할 수 있다.
    - 다른 함수들은 속성을 하나 지정해줘야 한다.
    - COUNT 함수에서도 속성을 하나만 지정해줄 수도 있는데, 이 경우 NULL 값은 제외되므로 기대와 다른 결과가 나올 수 있음에 유의
      - 모든 튜플의 갯수를 세고 싶은 것이라면, 널 값이 없는 기본키 속성이나 *를 이용해 계산한다.
    - COUNT 함수에서 DISTINCT 키워드를 사용해 특정 속성 값의 중복을 없애고 집계 함수를 적용할 수도 있다.
- 그룹별 검색
  - 테이블에서 특정 속성의 값이 같은 튜플을 모아 그룹을 만들고, 그룹별로 검색을 하기 위해 GROUP BY 키워드 사용
    - 그룹에 대한 조건을 추가하려면 HAVING 키워드와 같이 사용
    - GROUP BY 키워드가 없는 SELECT 문은 테이블 전체를 하나의 그룹으로 보고 검색하는 것이다.
  - 그룹별로 검색할 때는 어떤 그룹에 대한 검색 결과인지 확인하기 위해 그룹을 나누는 기준이 되는 속성을 SELECT 절에도 작성하는 것을 권장
  - 일반적인 검색 조건은 WHERE 절에 작성하지만 그룹에 대한 조건은 HAVING 절에 작성한다.
    - 집계함수는 WHERE 절에서는 사용할 수 없지만 HAVING 절에서는 사용할 수 있다.
  - 그룹별로 검색할 때는 집계 함수나 GROUP BY 절에 있는 속성 외의 속성은 SELECT 절에 사용할 수 없다.
  - (GROUP BY 주문제품, 주문고객)과 그룹핑한다면, 주문제품을 기준으로 1차로 그룹을 나누고, 각 그룹에서 주문고객별로 더 작게 2차로 그룹짓게 된다.
    - p03라는 주문제품을 apple이라는 주문 고객이 2번 주문했다면, 2번의 주문이 하나의 그룹으로 들어간다.
- 조인 검색
  - 테이블을 연결하려면, 조인 속성의 이름은 달라도 되지만 도메인은 반드시 같아야 한다.
- 부속 질의문(서브쿼리)을 이용한 검색
  - 서브쿼리는 ORDER BY 절을 사용할 수 없으며, 상위 쿼리보다 먼저 수행된다.
  - 단일 행 서브쿼리
    - 일반 비교 연산자 사용 가능
  - 다중 행 서브쿼리
    - 일반 비교 연산자 사용 불가능
    - IN, NOT IN, EXISTS, NOT EXISTS, ALL, ANY(=SOME)
      - ALL, ANY(=SOME)는 비교연산자와 함께 사용
  - GPT: 코릴레이티드 서브쿼리(Correlated Subquery)는 상위 쿼리(Main Query)의 각 행을 참조하여 실행되는 서브쿼리
    - 코릴레이티드 서브쿼리는 상위 쿼리의 각 행을 기반으로 실행됨 → 상위 쿼리의 각 행마다 서브쿼리가 재실행됨 -> 성능에 부담
    - 조인을 사용하면 서브쿼리를 피하면서 성능 최적화 가능
    - 서브쿼리와 성능의 관계에 대해 더 공부할 필요가 있겠다.
    - https://jojoldu.tistory.com/520

### 뷰
- 다른 테이블을 기반으로 만들어진 가상 테이블
  - 일반 테이블과 달리 데이터를 실제로 저장하고 있지 않기 때문에 검색할 수는 있지만 기본 테이블의 내용을 바꾸는 작업은 제한적으로 이루어진다.
```SQL
CREATE VIEW 뷰_이름[(속성_리스트)]
AS SELECT 문
[WITH CHECK OPTION];
```
- ORDER BY 문을 사용할 수 없다는 점만 제외하면 일반 SELECT 문과 동일
  - 오라클과 같은 일부 DBMS에서는 뷰를 생성하기 위한 SELECT 문에서 ORDER BY 사용을 허용
- WITH CHECK OPTION은 생성한 뷰에 삽입이나 수정 연산을 할 때 SELECT 문에서 WHERE 키워드와 함께 제시한 뷰의 정의 조건을 위반하면 수행되지 않도록 하는 제약조건을 의미
- 뷰에 대한 SELECT 문이 내부적으로는 기본 테이블에 대한 SELECT 문으로 변환되어 수행되는 원리
- 기본 테이블에서 어떤 튜플을 어떻게 변경해야 할지 명확히 제시하지 못하는 뷰는 변경이 허용되지 않는다.
  - 기본 테이블의 기본키를 구성하는 속성이 포함되어 있지 않은 뷰는 변경할 수 없다.
  - 기본 테이블에서 NOT NULL로 지정된 속성이 포함되어 있지 않은 뷰는 변경할 수 없는 경우가 있다.
  - 기본 테이블에 있던 내용이 아니라 집계 함수로 새로 계산된 내용을 포함하고 있는 뷰는 변경할 수 없다.
  - DISTINCT 키워드를 포함하여 정의한 뷰는 변경할 수 없다.
  - GROUP BY 절을 포함하여 정의한 뷰는 변경할 수 없다.
  - 여러 개의 테이블을 조인하여 정의한 뷰는 변경할 수 없는 경우가 많다.
- 뷰를 쓰는 이유
  - 특정 조건들을 만족하는 튜플들로 뷰를 미리 만들어 놓으면 쿼리를 좀 더 쉽게 작성할 수 있다.
  - 여러 사용자의 요구에 맞는 다양한 뷰를 미리 정의해두고, 사용자가 자신에게 제공된 뷰를 통해서만 데이터에 접근하도록 권한을 설정하면, 뷰에 포함되지 않은 데이터를 사용자로부터 보호할 수 있다.
  - 제공된 뷰에 포함되지 않은 기본 테이블의 다른 부분은 사용자가 신경 쓸 필요가 없고, 제공된 뷰와 관련이 없는 다른 테이블의 변화에도 영향을 받지 않아 사용자 입장에서 데이터 관리에 편리하다.

### 삽입 SQL (Embedded SQL)
- 프로그래밍 언어로 작성된 응용 프로그램 안에 삽입하여 사용하는 SQL문
- 수행 결과로 여러 개의 행을 반환하는 SELECT 문을 삽입 SQL문으로 사용하는 경우에는 커서라는 도구가 필요하다.
- 지금은 딱히 필요성이 와닿지 않아서 필요한 경우에 더 공부하자.
